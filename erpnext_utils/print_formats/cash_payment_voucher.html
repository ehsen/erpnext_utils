<div class="do-print-wrap">
  <div class="a5-landscape" style="width: 100%; height: 148mm; padding: 10px 15px 60px 15px; font-family: Arial, sans-serif; font-size: 11px; box-sizing: border-box; position: relative;">

    <!-- Header Section -->
    <div style="text-align: center; margin-bottom: 12px;">
      <h2 style="margin: 0; font-size: 18px; font-weight: bold;">{{ doc.company or '' }}</h2>
      
      <!-- Company Address -->
      {% set company_address = frappe.get_list('Address', filters={'is_your_company_address': 1, 'address_type': 'Billing'}, fields=['address_line1', 'address_line2', 'city', 'state', 'country', 'pincode', 'phone'], limit=1) %}
      {% if company_address and company_address|length > 0 %}
        <div style="margin-top: 3px; font-size: 10px;">
          {{ company_address[0].address_line1 or '' }}{% if company_address[0].address_line2 %}, {{ company_address[0].address_line2 }}{% endif %}, {{ company_address[0].city or '' }}{% if company_address[0].state %}, {{ company_address[0].state }}{% endif %}, {{ company_address[0].country or '' }}{% if company_address[0].pincode %} - {{ company_address[0].pincode }}{% endif %}{% if company_address[0].phone %}, Phone: {{ company_address[0].phone }}{% endif %}
        </div>
      {% endif %}
    </div>

    <!-- Title -->
    <div style="text-align: center; margin-bottom: 12px;">
      <h3 style="margin: 0; font-size: 16px; font-weight: bold; text-decoration: underline;">CASH PAYMENT VOUCHER</h3>
    </div>

    <!-- Document Details -->
    <div style="margin-bottom: 10px; display: flex; gap: 10px;">
      <table style="width: 48%; border-collapse: collapse; font-size: 10px;">
        <tr>
          <td style="border: none; padding: 2px; width: 40%;"><strong>Voucher No:</strong></td>
          <td style="border: none; padding: 2px; width: 60%;">{{ doc.name or '' }}</td>
        </tr>
        <tr>
          <td style="border: none; padding: 2px;"><strong>Paid To:</strong></td>
          <td style="border: none; padding: 2px;">{{ doc.paid_to or '' }}</td>
        </tr>
        <tr>
          <td style="border: none; padding: 2px;"><strong>Remarks:</strong></td>
          <td style="border: none; padding: 2px;">{{ doc.remarks or '' }}</td>
        </tr>
      </table>
      <table style="width: 48%; border-collapse: collapse; font-size: 10px;">
        <tr>
          <td style="border: none; padding: 2px; width: 40%;"><strong>Date:</strong></td>
          <td style="border: none; padding: 2px; width: 60%;">{{ frappe.utils.format_date(doc.posting_date, "dd-MM-yyyy") if doc.posting_date else '' }}</td>
        </tr>
        <tr>
          <td style="border: none; padding: 2px;"><strong>Cash Account:</strong></td>
          <td style="border: none; padding: 2px;">{{ doc.voucher_account or '' }}</td>
        </tr>
      </table>
    </div>

    <!-- Accounts Table -->
    <div style="margin-bottom: 12px;">
      <table style="width: 100%; border-collapse: collapse; font-size: 10px;">
        <thead>
          <tr>
            <th style="text-align: center; width: 5%;">#</th>
            <th style="text-align: left; width: 40%;">Account</th>
            <th style="text-align: left; width: 35%;">Narration</th>
            <th style="text-align: right; width: 20%;">Amount</th>
          </tr>
        </thead>
        <tbody>
          {% for account in doc.accounts %}
          <tr>
            <td style="text-align: center;">{{ loop.index }}</td>
            <td style="padding-left: 4px;">{{ account.account or '' }}</td>
            <td style="padding-left: 4px;">{{ account.narration or '' }}</td>
            <td style="text-align: right; padding-right: 4px;">{{ "{:,.2f}".format(account.amount or 0) }}</td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot>
          <tr style="font-weight: bold; background-color: #f0f0f0;">
            <td colspan="3" style="text-align: right; padding-right: 4px;">Total Payment:</td>
            <td style="text-align: right; padding-right: 4px;">{{ "{:,.2f}".format(doc.total_payment or 0) }}</td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Amount in Words -->
    <div style="margin-bottom: 12px; font-size: 10px;">
      <strong>Amount in Words:</strong> {{ frappe.utils.money_in_words(doc.total_payment or 0) }}
    </div>

    <!-- Signature Section -->
    <div class="signature-section">
      <div class="signature-row">
        <div class="signature-item">
          <strong>Prepared By</strong>
          <div class="signature-line"></div>
        </div>
        <div class="signature-item">
          <strong>Checked By</strong>
          <div class="signature-line"></div>
        </div>
        <div class="signature-item">
          <strong>Authorised By</strong>
          <div class="signature-line"></div>
        </div>
        <div class="signature-item">
          <strong>Received By</strong>
          <div class="signature-line"></div>
        </div>
        <div class="signature-item">
          <strong>Posted By</strong>
          <div class="signature-line"></div>
        </div>
      </div>
    </div>

  </div>
</div>
